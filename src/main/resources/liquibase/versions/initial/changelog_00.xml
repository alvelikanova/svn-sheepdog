<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<!-- This initial version includes tables for svn-sheepdog project -->

	<changeSet id="user_table_init" author="ivan.spread" context="initial">

		<createTable tableName="User">
			<column name="id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>

			<column name="login" type="varchar(128)">
				<constraints nullable="false" unique="true" />
			</column>

			<column name="first_name" type="varchar(128)">
				<constraints nullable="false" />
			</column>

			<column name="last_name" type="varchar(256)">
				<constraints nullable="false" />
			</column>

			<column name="email" type="varchar(128)">
				<constraints nullable="false" unique="true" />
			</column>

			<column name="password" type="varchar(2048)">
				<constraints nullable="false" />
			</column>
		</createTable>

	</changeSet>

	<changeSet id="sucsription_table_init" author="ivan.spread"
		context="initial">

		<createTable tableName="Subscription">
			<column name="id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>

			<column name="file_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_subscription_file" />
			</column>

			<column name="user_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_subscription_user" />
			</column>
		</createTable>
	</changeSet>
	
	
	<changeSet id="project_table_init" author="velikanova.alenka" context="initial">
        
        <createTable tableName="project">
        
            <column name="id" autoIncrement="true" type="int"> 
        		<constraints primaryKey="true" />
      		</column>
      		
            <column name="name" type="varchar(256)">
                <constraints nullable="false"/>
            </column>
            
            <column name="url" type="varchar(2048)">
                <constraints nullable="false"/>
            </column>
            
            <column name="user_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_project_user" />
			</column>
			
        </createTable>
        
        <addUniqueConstraint constraintName="project_uc"
                            columnNames="id, name, url" tableName="project"/>
    </changeSet>
    
    <changeSet id="file_table_init" author="velikanova.alenka" context="initial">
        
        <createTable tableName="file">
        
            <column name="id" autoIncrement="true" type="int"> 
        		<constraints primaryKey="true" primaryKeyName="PK_file" />
      		</column>
      		
            <column name="name" type="varchar(256)">
                <constraints nullable="false"/>
            </column>
            
            <column name="qualified_name" type="varchar(2048)">
                <constraints nullable="false"/>
            </column>
            
            <column name="creator_name" type="varchar(128)">
                <constraints nullable="false"/>
            </column>
            
            <column name="revision_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_file_revision" />
			</column>
			
			<column name="project_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_file_project" />
			</column>
			
        </createTable> 
        
        <addUniqueConstraint constraintName="file_uc"
        	columnNames="id, qualified_name" tableName="file"/> 
        	
    </changeSet>
    
	<changeSet id="tweet_table_init" author="slastena.pro" context="initial">

		<createTable tableName="Tweet">
			<column name="id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			
			<column name="author" type="varchar(128)">
				<constraints nullable="false"  />
			</column>

			<column name="tweet" type="varchar(2048)">
				<constraints nullable="false" />
			</column>
			
			<column name="revision_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_tweet_revision" />
			</column>

		<changeSet id="revision_table_init" author="slastena.pro" context="initial">

		<createTable tableName="Revision">
			<column name="id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			
			<column name="revision_no" type="int">
				<constraints nullable="false"  />
			</column>

			<column name="author" type="varchar(128)">
				<constraints nullable="false" />
			</column>	
			
			<column name="comment" type="varchar(2048)">
				<constraints nullable="false" />
			</column>	
			
			<column name="project_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_revision_project" />
			</column>
		</createTable>

	</changeSet>
</databaseChangeLog>